<?xml version="1.0" encoding="utf-8"?>
<modules:VisuModuleBase xmlns:fx="http://ns.adobe.com/mxml/2009" 
		   xmlns:s="library://ns.adobe.com/flex/spark" 
		   xmlns:mx="library://ns.adobe.com/flex/mx" 
		   xmlns:modules="com.ithaca.visu.modules.*" 
		   xmlns:maps="maps.*"
		   xmlns:mate="http://mate.asfusion.com/"
		   xmlns:controls="com.ithaca.visu.controls.*"
		   configure="configureHandler(event)"
		   creationComplete="creationCompleteHandler(event)"
		   top="0" bottom="0" left="0" right="0" 
		   >
	<fx:Declarations>
	</fx:Declarations>
	<fx:Script>
		<![CDATA[
			import com.ithaca.visu.events.VisuModuleEvent;
			import com.ithaca.visu.ui.utils.ConnectionStatus;
			import com.lyon2.visu.model.Model;
			import com.lyon2.visu.model.User;
			import com.ithaca.visu.events.SessionEvent;
			
			import mx.events.FlexEvent;			

			
			protected function creationCompleteHandler(event:FlexEvent):void
			{
				// check status logged user
				var loggedUser:User =  Model.getInstance().getLoggedUser();
				var statusLoggedUser:int =loggedUser.status; 
				if(statusLoggedUser == ConnectionStatus.CONNECTED)
				{
					Model.getInstance().updateStatusLoggedUser(ConnectionStatus.PENDING);
					var outSession:SessionEvent = new SessionEvent(SessionEvent.OUT_SESSION);
					outSession.userId = loggedUser.id_user;
					this.dispatchEvent(outSession);
				}
			}
			
			protected function configureHandler(event:VisuModuleEvent):void
			{				
				if((event.currentTarget as UserModule).parameters != null)
				{
					var param:Object = (event.currentTarget as UserModule).parameters ;
					if(testLabel != null)
					{
						testLabel.text = param.theme + " " + param.date_session.toString();
					}
				}
			}
			
	
		]]>
	</fx:Script>
	<s:VGroup>
		<s:Label fontSize="20" text="Gestion des utilisateurs"  y="500"/>
		<s:Label fontSize="20" text=".."  y="500" id="testLabel"/>
	</s:VGroup>
</modules:VisuModuleBase>
